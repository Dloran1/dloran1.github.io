<!DOCTYPE html>
<html lang="en-gb">
<head>
  <meta charset="utf-8">
  <title>DNS Leak with a VPN (2026): How to Test & Fix DNS/IPv6/WebRTC Leaks | VPN World</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="2026 practical guide: what a DNS leak is, how to test DNS/IPv6/WebRTC, and how to fix leaks on Windows, macOS, Android, iOS, and routers ‚Äî with realistic privacy limits.">
  <meta name="robots" content="index, follow">

  <link rel="icon" href="/favicon.ico">
  <link rel="canonical" href="https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html">

  <!-- HREFLANG (7√ó + x-default) -->
  <link rel="alternate" hreflang="pl" href="https://dloran1.github.io/blog/wyciek-dns-vpn.html">
  <link rel="alternate" hreflang="en-gb" href="https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html">
  <link rel="alternate" hreflang="en-us" href="https://dloran1.github.io/en-us/blog/vpn-dns-leak.html">
  <link rel="alternate" hreflang="de" href="https://dloran1.github.io/de/blog/vpn-dns-leak.html">
  <link rel="alternate" hreflang="es" href="https://dloran1.github.io/es/blog/vpn-dns-leak.html">
  <link rel="alternate" hreflang="fr" href="https://dloran1.github.io/fr/blog/vpn-dns-leak.html">
  <link rel="alternate" hreflang="nl-be" href="https://dloran1.github.io/nl-be/blog/vpn-dns-leak.html">
  <link rel="alternate" hreflang="x-default" href="https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html">

  <!-- Styles -->
  <link rel="stylesheet" href="../../assets/css/style.css">

  <!-- Preconnect -->
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="VPN World">
  <meta property="og:locale" content="en_GB">
  <meta property="og:locale:alternate" content="pl_PL">
  <meta property="og:locale:alternate" content="en_US">
  <meta property="og:locale:alternate" content="de_DE">
  <meta property="og:locale:alternate" content="es_ES">
  <meta property="og:locale:alternate" content="fr_FR">
  <meta property="og:locale:alternate" content="nl_BE">
  <meta property="og:title" content="DNS Leak with a VPN (2026): How to Test & Fix DNS/IPv6/WebRTC Leaks">
  <meta property="og:description" content="Test DNS/IPv6/WebRTC in minutes and fix leaks on Windows, macOS, Android, iOS and routers ‚Äî with realistic privacy limits.">
  <meta property="og:url" content="https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html">
  <meta property="og:image" content="https://dloran1.github.io/assets/img/hero/vpn-dns-leak-uk.webp">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="DNS Leak with a VPN (2026): How to Test & Fix DNS/IPv6/WebRTC Leaks">
  <meta name="twitter:description" content="2026 practical guide: detect and fix DNS/IPv6/WebRTC leaks with a repeatable checklist.">
  <meta name="twitter:image" content="https://dloran1.github.io/assets/img/hero/vpn-dns-leak-uk.webp">

  <!-- GA4 + Consent Mode v2 (DEFAULT DENIED) -->
  
<!-- Stage 2.5: hard high-contrast fix for tables + SVG (must override dark theme) -->
  <style>
    /* --- TABLE FIX: always readable on dark/light --- */
    .table-scroll{overflow-x:auto;-webkit-overflow-scrolling:touch;margin:14px 0;border-radius:14px}
    .table-scroll table{min-width:720px;background:#fff !important;color:#000 !important;border-collapse:collapse;width:100%}
    .table-scroll caption{caption-side:top;text-align:left;font-weight:800;color:#000 !important;padding:10px 8px}
    .table-scroll th,.table-scroll td{border:3px solid #000 !important;padding:10px 10px;vertical-align:top;color:#000 !important;background:#fff !important}
    .table-scroll thead th{background:#fff !important}
    .table-scroll tbody tr:nth-child(even) td{background:#fff !important}
    .table-scroll a{color:#000 !important;text-decoration:underline;font-weight:800}

    /* --- SVG FIX: always readable on dark/light --- */
    .svg-card{background:#fff;border:3px solid #000;border-radius:16px;padding:12px;margin:14px 0}
    .svg-scroll{overflow-x:auto;-webkit-overflow-scrolling:touch}
    .svg-card svg{max-width:100%;height:auto;display:block;color:#000}
    .svg-card svg text{fill:#000 !important;font-weight:800}
    .svg-card .svg-caption{margin:10px 0 0;font-size:13px;color:#000;font-weight:700}

    .badge-row{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 0}
    .badge{display:inline-flex;align-items:center;gap:8px;border:3px solid #000;border-radius:999px;padding:7px 10px;background:#fff;color:#000;font-weight:800}
    .badge-dot{width:12px;height:12px;border-radius:999px;border:3px solid #000;background:#fff;display:inline-block}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;border:3px solid #000;border-radius:10px;padding:2px 8px;background:#fff;color:#000;font-weight:800}

    /* --- Related card style (dark wide card, green accent) --- */
    .related-card{background:#0b1220;border:2px solid rgba(255,255,255,.14);border-radius:18px;padding:14px 14px 14px 18px;margin:14px 0;position:relative}
    .related-card:before{content:"";position:absolute;left:10px;top:14px;bottom:14px;width:6px;border-radius:8px;background:#2bd576}
    .related-card strong{color:#eaeaea}
    .related-card a{color:#eaeaea;text-decoration:underline;font-weight:800}
    .related-grid{display:grid;grid-template-columns:1fr;gap:10px}
    @media (min-width:860px){.related-grid{grid-template-columns:1fr 1fr}}

    /* Small TOC */
    .toc{margin:12px 0 0;padding:12px 12px;border:2px solid rgba(255,255,255,.14);border-radius:14px;background:rgba(15,23,32,.25)}
    .toc a{text-decoration:underline}
  </style>

  <!-- JSON-LD (Stage 2.5): Article + FAQPage + BreadcrumbList + ItemList -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@graph":[
      {
        "@type":"Article",
        "@id":"https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html",
        "mainEntityOfPage":{"@type":"WebPage","@id":"https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html"},
        "headline":"DNS Leak with a VPN: Detection & Fixes (2026)",
        "description":"2026 practical guide: what a DNS leak is, how to test DNS/IPv6/WebRTC, and how to fix leaks on Windows, macOS, Android, iOS, and routers ‚Äî with realistic privacy limits.",
        "image":"https://dloran1.github.io/assets/img/hero/vpn-dns-leak-uk.webp",
        "inLanguage":"en-GB",
        "datePublished":"2026-01-06",
        "dateModified":"2026-02-22",
        "author":{"@type":"Person","name":"Denys Shchur","url":"https://dloran1.github.io/en-gb/about-denys-shchur.html"},
        "publisher":{"@type":"Organization","name":"VPN World","logo":{"@type":"ImageObject","url":"https://dloran1.github.io/assets/img/logo.png"}}
      },
      {
        "@type":"BreadcrumbList",
        "itemListElement":[
          {"@type":"ListItem","position":1,"name":"Home","item":"https://dloran1.github.io/en-gb/"},
          {"@type":"ListItem","position":2,"name":"Blog","item":"https://dloran1.github.io/en-gb/blog/"},
          {"@type":"ListItem","position":3,"name":"DNS Leak with a VPN: Detection & Fixes (2026)","item":"https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html"}
        ]
      },
      {
        "@type":"ItemList",
        "name":"Related articles",
        "itemListElement":[
          {"@type":"ListItem","position":1,"url":"https://dloran1.github.io/en-gb/blog/what-is-a-vpn-uk.html","name":"What is a VPN? (UK)"},
          {"@type":"ListItem","position":2,"url":"https://dloran1.github.io/en-gb/blog/vpn-kill-switch-uk.html","name":"VPN Kill Switch: stop leaks"},
          {"@type":"ListItem","position":3,"url":"https://dloran1.github.io/en-gb/blog/vpn-optimal-settings-uk.html","name":"Optimal VPN settings (UK)"},
          {"@type":"ListItem","position":4,"url":"https://dloran1.github.io/en-gb/blog/proxy-vs-vpn-uk.html","name":"Proxy vs VPN (UK)"},
          {"@type":"ListItem","position":5,"url":"https://dloran1.github.io/en-gb/blog/vpn-public-wifi-uk.html","name":"VPN on public Wi-Fi (UK)"},
          {"@type":"ListItem","position":6,"url":"https://dloran1.github.io/en-gb/blog/vpn-protocols-uk.html","name":"VPN protocols explained (UK)"},
          {"@type":"ListItem","position":7,"url":"https://dloran1.github.io/en-gb/blog/no-logs-vpn-uk.html","name":"No-logs VPN (UK)"}
        ]
      },
      {
        "@type":"FAQPage",
        "mainEntity":[
          {
            "@type":"Question",
            "name":"What is a DNS leak when using a VPN?",
            "acceptedAnswer":{"@type":"Answer","text":"A DNS leak happens when domain lookups (DNS queries) are sent outside the VPN tunnel ‚Äî often to your ISP or a network‚Äôs DNS ‚Äî even while the VPN appears connected. That can expose the sites you‚Äôre visiting as metadata."}
          },
          {
            "@type":"Question",
            "name":"Why do DNS leaks happen most often on Windows?",
            "acceptedAnswer":{"@type":"Answer","text":"Windows can prioritise multiple network adapters, cached DNS, and fallback resolvers. After updates, sleep/wake, or network changes (Wi-Fi to hotspot), DNS can briefly route outside the tunnel unless the VPN enforces DNS protection and a proper kill switch."}
          },
          {
            "@type":"Question",
            "name":"Is IPv6 a common cause of leaks?",
            "acceptedAnswer":{"@type":"Answer","text":"Yes. If your VPN protects IPv4 but doesn‚Äôt properly handle IPv6, some traffic (including DNS-related requests) may bypass the tunnel. Either use a VPN with solid IPv6 handling or disable IPv6 on that device/network."}
          },
          {
            "@type":"Question",
            "name":"Does a VPN make you anonymous?",
            "acceptedAnswer":{"@type":"Answer","text":"Not fully. A VPN helps protect the network layer (IP/DNS leaks), but logins, cookies, fingerprinting and app identifiers can still link activity to you. Treat a VPN as one strong privacy layer, not total anonymity."}
          }
        ]
      }
    ]
  }
  </script>
      <script src="/assets/js/cookie-consent.js" defer></script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RD6M691ZWD"></script>
</head>

<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="container header-inner">
      <div class="header-main">
        <a href="/en-gb/" class="brand">
          <img src="../../assets/img/logo.png" class="logo" alt="VPN World logo">
          <span class="brand-text">VPN World</span>
        </a>

        <nav class="primary-nav" aria-label="Main navigation">
          <a href="/en-gb/blog/">Blog</a>
        </nav>
      </div>

      <nav class="lang-switch" aria-label="Language switcher">
        <a href="/blog/wyciek-dns-vpn.html">Polski</a> |
        <a href="/en-gb/blog/vpn-dns-leak-uk.html" class="active">English (UK)</a> |
        <a href="/en-us/blog/vpn-dns-leak.html">English (US)</a> |
        <a href="/de/blog/vpn-dns-leak.html">Deutsch</a> |
        <a href="/es/blog/vpn-dns-leak.html">Espa√±ol</a> |
        <a href="/fr/blog/vpn-dns-leak.html">Fran√ßais</a> |
        <a href="/nl-be/blog/vpn-dns-leak.html">Nederlands (BE)</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <div class="container hero-inner">
        <div class="hero-copy">
          <h1>DNS Leak with a VPN: Detection &amp; Fixes (2026)</h1>

          <p class="note">
            <strong>Quick answer:</strong>
            A DNS leak means your DNS lookups (the domains you visit) escape the VPN tunnel. In this guide you‚Äôll test DNS/IPv6/WebRTC in minutes and apply fixes on Windows, macOS, Android, iOS and routers ‚Äî with realistic privacy limits.
          </p>


          <div class="emergency-fix-box" style="border: 3px solid #d9534f; padding: 18px; background: #fff5f5; border-radius: 12px; margin: 18px 0 18px;">
            <h2 style="color:#d9534f; margin:0 0 10px;">Quick Fix: DNS Leak 2026 (UK)</h2>
            <p style="margin:0 0 10px;">
              If your <strong>real DNS</strong> is visible (common on UK networks like <strong>BT</strong>, <strong>Virgin Media</strong> or <strong>Sky</strong>), do this immediately:
            </p>
            <ul style="font-weight:800; line-height:1.6; margin:0; padding-left: 18px;">
              <li>Enable <strong>‚ÄúForce VPN DNS‚Äù</strong> (or ‚ÄúUse VPN DNS only‚Äù) inside your VPN app.</li>
              <li>Disable <strong>IPv6</strong> (the #1 bypass in many Windows/ISP stacks).</li>
              <li>Set a trusted DNS (e.g., <strong>1.1.1.1</strong>) at OS level if your VPN client can‚Äôt lock DNS.</li>
              <li>Block <strong>WebRTC</strong> in your browser (uBlock Origin / browser setting) to stop browser-side leaks.</li>
            </ul>
          </div>

          <div class="table-scroll" aria-label="DNS leak risk comparison">
            <table>
              <caption>Leak levels: what your ISP can see, and the fastest 2026 fix</caption>
              <thead>
                <tr>
                  <th scope="col">Leak type</th>
                  <th scope="col">What an ISP can see (BT / Virgin / Sky)</th>
                  <th scope="col">Risk</th>
                  <th scope="col">Fastest fix (2026)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Standard DNS leak</strong></td>
                  <td>Domains you visit (site names), even if content is encrypted (HTTPS)</td>
                  <td>üî¥ High</td>
                  <td>Force VPN DNS / secure DNS in client</td>
                </tr>
                <tr>
                  <td><strong>IPv6 leak</strong></td>
                  <td>Real IPv6 + DNS path bypassing the tunnel</td>
                  <td>üî¥ Critical</td>
                  <td>Disable IPv6 or ensure VPN supports IPv6</td>
                </tr>
                <tr>
                  <td><strong>WebRTC leak</strong></td>
                  <td>Local / real IP via browser APIs</td>
                  <td>üü° Medium</td>
                  <td>Disable WebRTC / use uBlock Origin rules</td>
                </tr>
                <tr>
                  <td><strong>Teredo / tunnelling</strong></td>
                  <td>Hidden Windows tunnels that can send DNS outside VPN</td>
                  <td>üü° Medium</td>
                  <td><code>netsh interface teredo set state disabled</code></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="svg-card" style="margin-top:18px;">
            <div class="svg-scroll">
              <svg viewBox="0 0 1100 260" role="img" aria-label="Safe DNS path diagram" style="max-width:100%; height:auto; color:#000;">
                <rect x="0" y="0" width="1100" height="260" fill="#fff"></rect>
                <style>
                  svg text{fill:#000 !important; font-weight:800;}
                  .b{stroke:#000; stroke-width:4; fill:#fff;}
                  .a{stroke:#000; stroke-width:4; fill:#e9f7ff;}
                  .arrow{stroke:#000; stroke-width:4; fill:none; marker-end:url(#m);}
                </style>
                <defs>
                  <marker id="m" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
                    <path d="M 0 0 L 10 5 L 0 10 z" fill="#000"></path>
                  </marker>
                </defs>
                <rect class="b" x="30" y="70" width="200" height="110" rx="16"></rect>
                <text x="130" y="125" text-anchor="middle" font-size="28">You</text>
                <text x="130" y="155" text-anchor="middle" font-size="18">Device / Browser</text>

                <rect class="a" x="290" y="70" width="240" height="110" rx="16"></rect>
                <text x="410" y="118" text-anchor="middle" font-size="24">VPN Tunnel</text>
                <text x="410" y="150" text-anchor="middle" font-size="18">AES encryption</text>

                <rect class="b" x="590" y="70" width="240" height="110" rx="16"></rect>
                <text x="710" y="118" text-anchor="middle" font-size="22">Private DNS</text>
                <text x="710" y="150" text-anchor="middle" font-size="18">VPN DNS / DoH</text>

                <rect class="b" x="890" y="70" width="180" height="110" rx="16"></rect>
                <text x="980" y="125" text-anchor="middle" font-size="22">Internet</text>

                <path class="arrow" d="M 230 125 L 290 125"></path>
                <path class="arrow" d="M 530 125 L 590 125"></path>
                <path class="arrow" d="M 830 125 L 890 125"></path>

                <text x="550" y="235" text-anchor="middle" font-size="18">Safe path: DNS stays inside the tunnel</text>
              </svg>
            </div>
          </div>

          <div class="svg-card" style="margin-top:14px;">
            <div class="svg-scroll">
              <svg viewBox="0 0 1100 300" role="img" aria-label="DNS leak path diagram" style="max-width:100%; height:auto; color:#000;">
                <rect x="0" y="0" width="1100" height="300" fill="#fff"></rect>
                <style>
                  svg text{fill:#000 !important; font-weight:800;}
                  .b{stroke:#000; stroke-width:4; fill:#fff;}
                  .warn{stroke:#000; stroke-width:4; fill:#ffe9e9;}
                  .arrow{stroke:#000; stroke-width:4; fill:none; marker-end:url(#m2);}
                  .leak{stroke:#000; stroke-width:4; fill:none; stroke-dasharray:10 8; marker-end:url(#m2);}
                </style>
                <defs>
                  <marker id="m2" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
                    <path d="M 0 0 L 10 5 L 0 10 z" fill="#000"></path>
                  </marker>
                </defs>

                <rect class="b" x="30" y="85" width="200" height="110" rx="16"></rect>
                <text x="130" y="140" text-anchor="middle" font-size="28">You</text>

                <rect class="b" x="290" y="85" width="240" height="110" rx="16"></rect>
                <text x="410" y="133" text-anchor="middle" font-size="24">VPN Tunnel</text>
                <text x="410" y="163" text-anchor="middle" font-size="18">Traffic protected</text>

                <rect class="warn" x="590" y="20" width="260" height="110" rx="16"></rect>
                <text x="720" y="68" text-anchor="middle" font-size="22">LEAK!</text>
                <text x="720" y="98" text-anchor="middle" font-size="18">DNS to ISP resolver</text>

                <rect class="warn" x="890" y="20" width="180" height="110" rx="16"></rect>
                <text x="980" y="68" text-anchor="middle" font-size="18">ISP DNS</text>
                <text x="980" y="98" text-anchor="middle" font-size="16">(logged)</text>

                <rect class="b" x="890" y="170" width="180" height="110" rx="16"></rect>
                <text x="980" y="230" text-anchor="middle" font-size="20">Internet</text>

                <path class="arrow" d="M 230 140 L 290 140"></path>
                <path class="arrow" d="M 530 140 L 890 225"></path>

                <path class="leak" d="M 530 110 L 590 75"></path>
                <path class="leak" d="M 850 75 L 890 75"></path>

                <text x="550" y="285" text-anchor="middle" font-size="18">Leak path: DNS bypasses the tunnel and hits your ISP</text>
              </svg>
            </div>
          </div>

          <section id="dns-fixer" style="margin-top: 22px;">
            <h2>The DNS Leak Emergency Fixer Dashboard</h2>
            <p class="note"><strong>How it works:</strong> tick each fix you‚Äôve applied. Your progress score updates instantly, and the panel suggests what to do next.</p>

            <div class="checklist-wrapper" style="max-width: 100%; margin: 0 auto;">
              <div id="dns-status-card" style="border: 4px solid #000; padding: 18px; background: #fff; margin-bottom: 16px; border-radius: 15px;">
                <div id="dns-status-label" style="font-weight: 900; font-size: 1.25em; margin-bottom: 10px;">Status: At risk (0%)</div>
                <div style="background: #eee; height: 26px; border: 2px solid #000; margin-bottom: 10px; position: relative; overflow: hidden; border-radius: 7px;">
                  <div id="dns-progress-bar" style="background: #00ff00; width: 0%; height: 100%; transition: width 0.25s ease;"></div>
                </div>
                <div id="dns-status-tip" style="font-style: italic; color: #333; font-size: 0.95em; line-height: 1.35;">
                  Start with <strong>Force VPN DNS</strong> and <strong>Disable IPv6</strong> ‚Äî these two fix most UK leaks.
                </div>
              </div>

              <div id="dns-detail" style="border:2px solid #000; background:#fff; border-radius:14px; padding:14px; margin-bottom:14px;">
                <div style="font-weight:900; margin-bottom:6px;">Selected fix</div>
                <div id="dns-detail-title" style="font-weight:900; font-size:1.05em;">‚Äî</div>
                <div id="dns-detail-cmd" style="margin-top:6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size:0.92em; white-space:pre-wrap;">‚Äî</div>
                <div id="dns-detail-why" style="margin-top:8px; color:#222; line-height:1.35;">Tap a card to see the exact action, command, or setting path.</div>
              </div>

              <div id="dns-cards-grid" style="display: grid; grid-template-columns: 1fr; gap: 12px;"></div>

              <div style="display:flex; gap:10px; margin-top: 16px;">
                <button id="dns-reset" style="flex:1; padding: 14px; background:#000; color:#fff; border:none; font-weight:900; cursor:pointer; border-radius: 10px; text-transform: uppercase;">Reset dashboard</button>
                <button id="dns-clear" style="flex:1; padding: 14px; background:#fff; color:#000; border:3px solid #000; font-weight:900; cursor:pointer; border-radius: 10px; text-transform: uppercase;">Clear</button>
              </div>
            </div>

            <style>
              /* Local widget helpers (high-contrast, mobile-first) */
              #dns-cards-grid .dns-card{
                border: 3px solid #000;
                padding: 14px;
                background: #fff;
                display:flex;
                align-items:flex-start;
                gap: 14px;
                cursor:pointer;
                border-radius: 14px;
              }
              #dns-cards-grid .dns-card.is-done{
                background: #f0fff0;
              }
              #dns-cards-grid .dns-card .dns-title{
                font-weight: 900;
                font-size: 1.02em;
                line-height: 1.25;
              }
              #dns-cards-grid .dns-card.is-done .dns-title{
                text-decoration: line-through;
                text-decoration-thickness: 3px;
              }
              #dns-cards-grid .dns-card .dns-why{
                font-size: 0.9em;
                color: #222;
                line-height: 1.35;
              }
              #dns-cards-grid .dns-card.is-done .dns-why{
                opacity: 0.85;
              }
              #dns-cards-grid input[type="checkbox"]{
                width: 26px;
                height: 26px;
                margin-top: 2px;
              }
            </style>

            <script>
            (function(){
              const STORE_KEY = 'vw_dns_leak_fixer_2026_en_gb_v1';

              const grid = document.getElementById('dns-cards-grid');
              const bar = document.getElementById('dns-progress-bar');
              const statusLabel = document.getElementById('dns-status-label');
              const statusTip = document.getElementById('dns-status-tip');

              const detailTitle = document.getElementById('dns-detail-title');
              const detailCmd = document.getElementById('dns-detail-cmd');
              const detailWhy = document.getElementById('dns-detail-why');

              const resetBtn = document.getElementById('dns-reset');
              const clearBtn = document.getElementById('dns-clear');

              const items = [
                {t:'Force VPN DNS (app setting)', c:'VPN app ‚Üí Settings ‚Üí DNS ‚Üí ‚ÄúUse VPN DNS only‚Äù / ‚ÄúForce VPN DNS‚Äù', w:'This stops the client from falling back to your ISP resolver during reconnection. Many ‚Äúmystery‚Äù leaks are just DNS fallback.'},
                {t:'Disable IPv6 (fast test)', c:'Windows: Network Connections ‚Üí Adapter ‚Üí Properties ‚Üí uncheck ‚ÄúInternet Protocol Version 6 (TCP/IPv6)‚Äù', w:'UK ISP IPv6 stacks can bypass a VPN tunnel if the client is IPv4-only or misconfigured. Either enable IPv6 support in the VPN, or disable IPv6.'},
                {t:'Disable Teredo tunnelling', c:'Run (Admin CMD): netsh interface teredo set state disabled', w:'Teredo creates hidden IPv6 tunnels that can leak routes and DNS outside VPN rules.'},
                {t:'Disable ‚ÄúSmart Multi-Homed Name Resolution‚Äù (Win 11)', c:'gpedit.msc ‚Üí Computer Configuration ‚Üí Administrative Templates ‚Üí Network ‚Üí DNS Client ‚Üí Turn off smart multi-homed name resolution = Enabled', w:'Windows can send DNS queries to multiple adapters (Ethernet/Wi‚ÄëFi/VPN). Turning this off prevents ‚Äúparallel‚Äù DNS leaks.'},
                {t:'Enable system kill switch', c:'VPN app ‚Üí Kill Switch ‚Üí System-level / Always-on', w:'If the VPN drops for 1 second, Windows can immediately query ISP DNS. A kill switch blocks traffic until the tunnel is back.'},
                {t:'Check for a second DNS app', c:'Look for: NextDNS / AdGuard / ‚ÄúSecure DNS‚Äù tools running in background', w:'Multiple DNS resolvers at once can override your VPN DNS setting and cause split behaviour.'},
                {t:'Set secure DNS in browser (Chrome/Edge)', c:'Settings ‚Üí Privacy ‚Üí Security ‚Üí Use secure DNS ‚Üí Choose provider (Cloudflare)', w:'Browser secure DNS reduces leaks when the OS resolver is unstable ‚Äî but it‚Äôs not a full replacement for VPN DNS.'},
                {t:'Disable WebRTC leaks', c:'Install uBlock Origin ‚Üí enable ‚ÄúPrevent WebRTC from leaking local IP‚Äù (or use browser setting)', w:'WebRTC can expose local IPs to websites even with a VPN. Disable it for sensitive browsing.'},
                {t:'Flush DNS cache', c:'Windows (Admin CMD): ipconfig /flushdns', w:'After changing DNS settings, flushing cache prevents stale resolver entries from producing false leak results.'},
                {t:'Restart network stack', c:'Windows: Settings ‚Üí Network & internet ‚Üí Advanced network settings ‚Üí Network reset (last resort)', w:'If you‚Äôve installed many VPN/DNS tools, the stack can get messy. Resetting adapters often fixes persistent leaks.'},
                {t:'Disable split tunnelling (temporarily)', c:'VPN app ‚Üí Split tunnelling ‚Üí Off', w:'Split tunnelling can route DNS outside the tunnel depending on client design. Turn it off when troubleshooting leaks.'},
                {t:'Bind VPN adapter on Windows', c:'Advanced adapter settings: prefer VPN DNS, lower metrics on non‚ÄëVPN adapters', w:'Adapter metrics influence which DNS server Windows prefers. A wrong metric can make ISP DNS ‚Äúwin‚Äù.'},
                {t:'Router DNS: avoid ISP defaults', c:'Router ‚Üí Internet/WAN DNS ‚Üí set 1.1.1.1 / 9.9.9.9 (if you trust them)', w:'If devices use router DNS, the router may forward to ISP DNS. Setting trusted DNS reduces household-wide leakage.'},
                {t:'Disable IPv6 on router (if VPN can‚Äôt handle IPv6)', c:'Router admin ‚Üí IPv6 ‚Üí Off', w:'If your VPN does not tunnel IPv6, router-level IPv6 can create leaks for every device.'},
                {t:'Check VPN protocol (WireGuard/OpenVPN)', c:'Try WireGuard/NordLynx vs OpenVPN (or vice versa)', w:'Some protocols handle DNS differently. Switching protocol is a quick way to eliminate client bugs.'},
                {t:'Turn on ‚ÄúBlock outside DNS‚Äù (Windows)', c:'If available in your VPN: ‚ÄúBlock internet when disconnected‚Äù', w:'This prevents Windows from reaching ISP DNS on reconnect events.'},
                {t:'Disable ‚ÄúPrivate DNS‚Äù conflicts (Android)', c:'Android ‚Üí Network ‚Üí Private DNS ‚Üí Off/Automatic (test)', w:'Private DNS can override VPN DNS on some devices. Test behaviour both ways.'},
                {t:'Use Always‚ÄëOn VPN (Android)', c:'Android ‚Üí VPN ‚Üí Always‚Äëon + Block connections without VPN', w:'This gives you a kill switch at OS level and reduces leak windows.'},
                {t:'iOS: turn off ‚ÄúLimit IP Address Tracking‚Äù (test)', c:'iOS Wi‚ÄëFi ‚Üí (i) ‚Üí Limit IP Address Tracking ‚Üí Off (temporary)', w:'Relay/obfuscation features can change DNS routes. Test without them to isolate the leak.'},
                {t:'Browser extensions audit', c:'Disable suspicious ‚ÄúVPN/DNS‚Äù extensions; keep only trusted ones', w:'Extensions can inject proxy settings or change DNS/DoH and create inconsistent results.'},
                {t:'Check for captive portals / public Wi‚ÄëFi', c:'On public Wi‚ÄëFi, open a non‚ÄëHTTPS page to complete the portal, then connect VPN', w:'Captive portals often block VPN DNS until you accept terms; this can look like a leak.'},
                {t:'Reinstall the VPN client', c:'Uninstall ‚Üí reboot ‚Üí install latest version', w:'Corrupted TAP/Wintun drivers or legacy configs are a common cause of leaks on Windows.'},
                {t:'Test with a clean browser profile', c:'Create a new browser profile (no extensions) and run tests', w:'This isolates WebRTC/DoH/extensions from OS-level DNS issues.'},
                {t:'Run a leak test after each change', c:'Use the ‚ÄúLeak tests‚Äù section below (DNS + IPv6 + WebRTC)', w:'Troubleshooting works only if you verify. Test after each fix so you know what actually solved the leak.'},
                {t:'Document your ‚Äúknown-good‚Äù settings', c:'Save a note: VPN app settings + OS DNS + router DNS', w:'If a future update breaks DNS, you can restore your safe baseline quickly.'}
              ];

              function loadState(){
                try{
                  const raw = localStorage.getItem(STORE_KEY);
                  const data = raw ? JSON.parse(raw) : {checked:[], last:-1};
                  if(!Array.isArray(data.checked)) data.checked = [];
                  if(typeof data.last !== 'number') data.last = -1;
                  return data;
                }catch(e){
                  return {checked:[], last:-1};
                }
              }

              function saveState(s){
                try{ localStorage.setItem(STORE_KEY, JSON.stringify(s)); }catch(e){}
              }

              function setDetail(idx){
                if(idx < 0 || idx >= items.length) return;
                const it = items[idx];
                if(detailTitle) detailTitle.textContent = it.t;
                if(detailCmd) detailCmd.textContent = it.c;
                if(detailWhy) detailWhy.textContent = it.w;
              }

              function setStatus(p){
                let label = '';
                let tip = '';
                if(p <= 15){
                  label = `Status: At risk (${p}%)`;
                  tip = 'Start with Force VPN DNS + Disable IPv6. These two fixes solve most UK cases.';
                }else if(p <= 45){
                  label = `Status: Basic protection (${p}%)`;
                  tip = 'Good start. Next: Teredo + Smart Multi-Homed DNS (Windows 11).';
                }else if(p <= 75){
                  label = `Status: Strong defence (${p}%)`;
                  tip = 'You‚Äôre close. Now audit WebRTC + split tunnelling and test again.';
                }else if(p < 100){
                  label = `Status: Nearly sealed (${p}%)`;
                  tip = 'Finish the remaining edge-cases: router IPv6/DNS and driver clean-up.';
                }else{
                  label = 'Status: DNS sealed (100%)';
                  tip = 'Excellent. Re-test occasionally after VPN/app updates or ISP router resets.';
                }
                if(statusLabel) statusLabel.textContent = label;
                if(statusTip) statusTip.textContent = tip;
                if(bar) bar.style.width = p + '%';
              }

              function updateStatus(){
                const s = loadState();
                const p = Math.round((s.checked.length / items.length) * 100);
                setStatus(p);
              }

              function render(){
                if(!grid) return;
                const state = loadState();
                grid.innerHTML = '';

                items.forEach((it, idx) => {
                  const done = state.checked.includes(idx);

                  const card = document.createElement('div');
                  card.className = 'dns-card' + (done ? ' is-done' : '');

                  card.innerHTML = `
                    <div style="font-weight:900; font-size:1.25em; min-width:32px; line-height:1;">${idx+1}</div>
                    <div style="flex:1;">
                      <div class="dns-title">${it.t}</div>
                      <div class="dns-why">${it.w}</div>
                    </div>
                    <div style="min-width:32px;">
                      <input type="checkbox" ${done ? 'checked' : ''} aria-label="Mark as done">
                    </div>
                  `;

                  const cb = card.querySelector('input');

                  const applyToggle = (checked) => {
                    const s = loadState();
                    const has = s.checked.includes(idx);
                    if(checked && !has) s.checked.push(idx);
                    if(!checked && has) s.checked = s.checked.filter(x => x !== idx);
                    s.last = idx;
                    saveState(s);
                    card.classList.toggle('is-done', checked);
                    setDetail(idx);
                    updateStatus();
                  };

                  // Click anywhere toggles + opens detail
                  card.addEventListener('click', (e) => {
                    if(e.target && e.target.tagName === 'INPUT') return;
                    cb.checked = !cb.checked;
                    applyToggle(cb.checked);
                  });

                  cb.addEventListener('change', () => applyToggle(cb.checked));

                  // Long-press feel: show details even without toggling
                  card.addEventListener('contextmenu', (e) => { e.preventDefault(); setDetail(idx); });

                  grid.appendChild(card);
                });

                // Restore last selection
                if(state.last >= 0) setDetail(state.last);
                updateStatus();
              }

              if(resetBtn){
                resetBtn.addEventListener('click', () => {
                  try{ localStorage.removeItem(STORE_KEY); }catch(e){}
                  if(detailTitle) detailTitle.textContent = '‚Äî';
                  if(detailCmd) detailCmd.textContent = '‚Äî';
                  if(detailWhy) detailWhy.textContent = 'Tap a card to see the exact action, command, or setting path.';
                  render();
                });
              }

              if(clearBtn){
                clearBtn.addEventListener('click', () => {
                  try{ localStorage.removeItem(STORE_KEY); }catch(e){}
                  render();
                });
              }

              if(document.readyState === 'loading'){
                document.addEventListener('DOMContentLoaded', render);
              }else{
                render();
              }
            })();
            </script>
          </section>


          <p>
            If you want a clean baseline first, read <a href="/en-gb/blog/what-is-a-vpn-uk.html">What is a VPN?</a>.
            If you just want ‚Äúfind & fix‚Äù, jump to <a href="#tests">Leak tests</a>.
          </p>

          <div class="hero-author">
            <img src="../../assets/img/author/denys-shchur.webp" alt="Denys Shchur ‚Äì author of VPN World">
            <div class="hero-author-text">
              <span class="hero-author-label">Written by</span>
              <span class="hero-author-name">
                <a href="/en-gb/about-denys-shchur.html" style="text-decoration:none;">Denys Shchur</a>
              </span>
              <span class="meta">Updated: 2026-02-22 ¬∑ 12‚Äì18 min read</span>
            </div>
          </div>

          <!-- Early CTA block (3 partners) -->
          <div class="cta-buttons" aria-label="Affiliate offers">
            <a href="https://go.nordvpn.net/aff_c?aff_id=2495&offer_id=312&url_id=2584" class="nordvpn" target="_blank" rel="nofollow sponsored noopener noreferrer">Try NordVPN ‚Äî DNS protection + kill switch</a>
            <a href="https://www.tkqlhce.com/click-101525886-17061430" class="surfshark" target="_blank" rel="nofollow sponsored noopener noreferrer">Try Surfshark ‚Äî RAM-only servers</a>
            <a href="https://www.dpbolvw.net/click-101525886-15834536" class="proton" target="_blank" rel="nofollow sponsored noopener noreferrer">Try Proton VPN ‚Äî privacy-first</a>
          </div>

          <div class="toc" aria-label="On-page navigation">
            <strong>On this page:</strong>
            <a href="#quick">Quick checklist</a> ¬∑
            <a href="#why">Why leaks happen</a> ¬∑
            <a href="#tests">How to test</a> ¬∑
            <a href="#fix">Fixes by device</a> ¬∑
            <a href="#faq">FAQ</a>
          </div>

          <ul class="meta-points">
            <li>Clear definitions (what matters, what doesn‚Äôt)</li>
            <li>Repeatable DNS/IPv6/WebRTC test routine</li>
            <li>Device fixes + practical ‚Äúedge cases‚Äù</li>
          </ul>
        </div>

        <div class="hero-media">
          <div class="hero-art">
            <img src="../../assets/img/hero/vpn-dns-leak-uk.webp" alt="Illustration for DNS leak detection and fixes (2026)">
          </div>
        </div>
      </div>
    </section>

    <!-- CONTENT -->
    <section class="section">
      <div class="container article">
        <!-- CONTENT_START -->

        <p>
          DNS leaks are one of the most common ways a ‚Äúconnected‚Äù VPN setup can still reveal sensitive metadata.
          A leak doesn‚Äôt necessarily expose the content of what you read ‚Äî but it can expose <strong>which domains</strong> you visit and when,
          which is often enough for profiling, filtering, or correlation.
        </p>

        <p>
          The good news: you can catch most leaks quickly with a simple routine and fix them with a small set of settings.
          The key is to test at the moments leaks usually happen: <strong>after updates</strong>, <strong>after sleep/wake</strong>, and <strong>after network changes</strong>.
        </p>

        <h2 id="quick">Quick checklist (60 seconds)</h2>
        <ul>
          <li>Connect VPN ‚Üí run DNS test ‚Üí confirm you don‚Äôt see ISP/hotspot DNS.</li>
          <li>Run IPv6 test ‚Üí confirm IPv6 is protected or intentionally disabled.</li>
          <li>Run WebRTC test in your main browser ‚Üí confirm it doesn‚Äôt expose a real public IP.</li>
          <li>Enable a proper <a href="/en-gb/blog/vpn-kill-switch-uk.html">kill switch</a> ‚Üí repeat after sleep/wake.</li>
          <li>Repeat after switching Wi-Fi ‚Üî hotspot or after a VPN/OS update.</li>
        </ul>
        <div class="key-takeaway"><strong>Key takeaway:</strong> ‚ÄúVPN connected‚Äù isn‚Äôt proof. A clean DNS/IPv6/WebRTC test is the proof.</div>

        <div class="badge-row" aria-label="Leak signals">
          <span class="badge"><span class="badge-dot" style="background:#dff7ff"></span>VPN IP looks changed</span>
          <span class="badge"><span class="badge-dot" style="background:#ffe8d6"></span>But DNS still shows ISP/hotspot</span>
          <span class="badge"><span class="badge-dot" style="background:#e9ffe8"></span>That‚Äôs a leak signal</span>
        </div>

        <!-- SVG 1: Leak vs tunnel -->
        <div class="svg-card">
          <div class="svg-scroll">
            <svg viewBox="0 0 980 320" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="DNS leak: secure tunnel path vs leaking DNS path">
              <rect x="0" y="0" width="980" height="320" fill="#fff"/>
              <rect x="30" y="40" width="280" height="240" rx="18" fill="#e7f3ff" stroke="#000" stroke-width="4"/>
              <text x="170" y="78" text-anchor="middle" font-size="18">Your device</text>

              <rect x="350" y="90" width="280" height="140" rx="18" fill="#f6ffe7" stroke="#000" stroke-width="4"/>
              <text x="490" y="126" text-anchor="middle" font-size="18">VPN tunnel</text>
              <text x="490" y="152" text-anchor="middle" font-size="14">(encrypted)</text>

              <rect x="670" y="40" width="280" height="240" rx="18" fill="#fff0f0" stroke="#000" stroke-width="4"/>
              <text x="810" y="78" text-anchor="middle" font-size="18">Internet / ISP</text>

              <!-- good path -->
              <path d="M 310 160 L 350 160" stroke="#000" stroke-width="6"/>
              <path d="M 630 160 L 670 160" stroke="#000" stroke-width="6"/>
              <polygon points="340,160 320,150 320,170" fill="#000"/>
              <polygon points="660,160 640,150 640,170" fill="#000"/>
              <text x="490" y="210" text-anchor="middle" font-size="14">Secure: DNS stays inside the tunnel</text>

              <!-- leak path -->
              <path d="M 250 105 C 420 10, 610 10, 780 105" fill="none" stroke="#000" stroke-width="6" stroke-dasharray="12,8"/>
              <polygon points="770,105 750,95 750,115" fill="#000"/>
              <text x="490" y="34" text-anchor="middle" font-size="20">DNS LEAK (DNS bypasses the tunnel)</text>

              <rect x="70" y="135" width="200" height="60" rx="14" fill="#fff" stroke="#000" stroke-width="4"/>
              <text x="170" y="170" text-anchor="middle" font-size="14">Browser / apps</text>

              <rect x="725" y="140" width="170" height="90" rx="14" fill="#fff" stroke="#000" stroke-width="4"/>
              <text x="810" y="176" text-anchor="middle" font-size="14">ISP DNS</text>
              <text x="810" y="202" text-anchor="middle" font-size="14">visible</text>
            </svg>
          </div>
          <div class="svg-caption">Diagram 1: A DNS leak happens when DNS lookups bypass the encrypted VPN tunnel.</div>
        </div>

        <h2 id="why">Why DNS leaks happen (and when they‚Äôre most likely)</h2>
        <p>
          In real life, leaks are rarely ‚Äúalways on‚Äù. They often show up at transition points:
          after an OS/VPN update, after sleep/wake, or when changing networks.
          Windows is the most common culprit due to adapter priority, caching and fallback behaviour.
        </p>

        <div class="table-scroll">
          <table>
            <caption>Common causes and what to check first</caption>
            <thead>
              <tr>
                <th>Cause</th>
                <th>Why it leaks</th>
                <th>Fast check</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>No proper kill switch</strong></td>
                <td>During brief disconnects DNS falls back to default resolvers.</td>
                <td>Enable kill switch + retest after sleep/wake.</td>
              </tr>
              <tr>
                <td><strong>Split tunnelling</strong></td>
                <td>Some traffic (or DNS) intentionally bypasses the tunnel.</td>
                <td>Turn split tunnelling off ‚Üí compare results.</td>
              </tr>
              <tr>
                <td><strong>IPv6 handling</strong></td>
                <td>VPN protects IPv4 but IPv6 escapes outside the tunnel.</td>
                <td>Run an IPv6 leak test; if leaking, use IPv6-safe VPN or disable IPv6.</td>
              </tr>
              <tr>
                <td><strong>DoH / browser DNS</strong></td>
                <td>The browser resolves DNS via its own channel.</td>
                <td>Check browser DoH settings ‚Üí retest.</td>
              </tr>
              <tr>
                <td><strong>Public Wi-Fi DNS enforcement</strong></td>
                <td>Hotspots push DNS/redirect rules (captive portals).</td>
                <td>Login first ‚Üí reconnect VPN ‚Üí retest.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p>
          If you frequently use caf√©s, hotels or trains, combine this with
          <a href="/en-gb/blog/vpn-public-wifi-uk.html">VPN on public Wi-Fi</a> and the
          <a href="/en-gb/blog/wifi-security-checklist-uk.html">Wi-Fi security checklist</a>.
        </p>

        <h2 id="tests">How to test DNS, IPv6 and WebRTC (a repeatable routine)</h2>
        <p>
          Do it like a mini lab: baseline <strong>without VPN</strong>, then <strong>with VPN</strong>, then <strong>after a reboot</strong>.
          This catches intermittent leaks that otherwise stay hidden for weeks.
        </p>

        <!-- SVG 2: Decision flow -->
        <div class="svg-card">
          <div class="svg-scroll">
            <svg viewBox="0 0 980 360" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Decision tree: test result and next step">
              <rect x="0" y="0" width="980" height="360" fill="#fff"/>
              <rect x="60" y="30" width="860" height="70" rx="16" fill="#fff" stroke="#000" stroke-width="4"/>
              <text x="490" y="74" text-anchor="middle" font-size="18">With VPN connected: do you see ISP / hotspot DNS?</text>

              <path d="M 490 100 L 490 130" stroke="#000" stroke-width="6"/>
              <rect x="110" y="140" width="360" height="80" rx="16" fill="#ffe8d6" stroke="#000" stroke-width="4"/>
              <text x="290" y="175" text-anchor="middle" font-size="16">YES ‚Üí leak likely</text>
              <text x="290" y="200" text-anchor="middle" font-size="13">Kill switch / split / IPv6 / DoH</text>

              <rect x="510" y="140" width="360" height="80" rx="16" fill="#e9ffe8" stroke="#000" stroke-width="4"/>
              <text x="690" y="175" text-anchor="middle" font-size="16">NO ‚Üí good</text>
              <text x="690" y="200" text-anchor="middle" font-size="13">Retest after reboot & network change</text>

              <path d="M 490 130 L 290 140" stroke="#000" stroke-width="6"/>
              <path d="M 490 130 L 690 140" stroke="#000" stroke-width="6"/>

              <rect x="110" y="240" width="360" height="90" rx="16" fill="#fff" stroke="#000" stroke-width="4"/>
              <text x="290" y="275" text-anchor="middle" font-size="14">Fix order</text>
              <text x="290" y="300" text-anchor="middle" font-size="12">1) Kill switch</text>
              <text x="290" y="322" text-anchor="middle" font-size="12">2) Split tunnelling off</text>
              <text x="290" y="344" text-anchor="middle" font-size="12">3) IPv6 / DoH</text>

              <rect x="510" y="240" width="360" height="90" rx="16" fill="#fff" stroke="#000" stroke-width="4"/>
              <text x="690" y="275" text-anchor="middle" font-size="14">Stability check</text>
              <text x="690" y="300" text-anchor="middle" font-size="12">Sleep / wake</text>
              <text x="690" y="322" text-anchor="middle" font-size="12">Wi-Fi ‚Üî hotspot</text>
              <text x="690" y="344" text-anchor="middle" font-size="12">Update day</text>
            </svg>
          </div>
          <div class="svg-caption">Diagram 2: A simple decision flow that turns a test result into the next action.</div>
        </div>

        <div class="table-scroll">
          <table>
            <caption>What ‚Äúgood‚Äù vs ‚Äúleak‚Äù looks like</caption>
            <thead>
              <tr>
                <th>Test</th>
                <th>Good (with VPN)</th>
                <th>Leak signal</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>DNS</strong></td>
                <td>Resolvers belong to the VPN or your intended secure configuration</td>
                <td>ISP/hotspot DNS appears</td>
              </tr>
              <tr>
                <td><strong>IPv6</strong></td>
                <td>IPv6 protected (VPN IPv6) or intentionally disabled</td>
                <td>Real IPv6 is visible</td>
              </tr>
              <tr>
                <td><strong>WebRTC</strong></td>
                <td>No real public IP exposed</td>
                <td>Real public IP appears in WebRTC results</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p>
          If you‚Äôre optimising your setup generally, see
          <a href="/en-gb/blog/vpn-optimal-settings-uk.html">optimal VPN settings</a> and
          <a href="/en-gb/blog/vpn-protocols-uk.html">VPN protocols</a>.
          Some speed tweaks (like split tunnelling) can also make leaks more likely.
        </p>

        <h2 id="fix">Fixes by device: Windows, macOS, Android, iOS and routers</h2>
        <p>
          The goal isn‚Äôt ‚Äúmore settings‚Äù. The goal is <strong>less randomness</strong>.
          Start with kill switch + DNS protection, then handle IPv6 and browser features.
        </p>

        <h3>Windows (most common leak point)</h3>
        <ul>
          <li>Enable DNS leak protection inside the VPN client (if offered).</li>
          <li>Enable a proper <a href="/en-gb/blog/vpn-kill-switch-uk.html">kill switch</a> and retest after sleep/wake.</li>
          <li>After changes, flush DNS: <span class="kbd">ipconfig /flushdns</span></li>
          <li>If your VPN doesn‚Äôt securely handle IPv6, disable IPv6 or use an IPv6-safe VPN configuration.</li>
        </ul>

        <h3>macOS</h3>
        <ul>
          <li>Enable DNS protection + auto-reconnect/always-on mode if available.</li>
          <li>Check DNS state: <span class="kbd">scutil --dns</span></li>
          <li>If leaks appear after sleep, reconnect VPN and retest.</li>
        </ul>

        <h3>Android</h3>
        <ul>
          <li>Enable ‚ÄúAlways-on VPN‚Äù and ‚ÄúBlock connections without VPN‚Äù (when available).</li>
          <li>Be careful with split tunnelling: keep it off unless you really need it.</li>
          <li>Retest after switching between Wi-Fi and mobile networks.</li>
        </ul>

        <h3>iOS</h3>
        <ul>
          <li>Prefer reputable official VPN apps and keep them updated.</li>
          <li>After long idle periods, retest ‚Äî leaks can happen around reconnect moments.</li>
          <li>If profiles get messy, reinstall the VPN profile (see <a href="/en-gb/blog/vpn-iphone-setup-uk.html">iPhone VPN setup</a>).</li>
        </ul>

        <h3>Routers</h3>
        <ul>
          <li>VPN on the router is great for Smart TVs and consoles (see <a href="/en-gb/blog/vpn-router-setup-uk.html">router VPN setup</a>).</li>
          <li>Set router/DHCP DNS to prevent devices falling back to ISP DNS.</li>
          <li>If you don‚Äôt need IPv6, disabling it on the router can eliminate common leak paths.</li>
        </ul>

        <!-- SVG 3: 3-layer model -->
        <div class="svg-card">
          <div class="svg-scroll">
            <svg viewBox="0 0 980 300" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Three-layer model to prevent leaks">
              <rect x="0" y="0" width="980" height="300" fill="#fff"/>
              <rect x="70" y="55" width="840" height="190" rx="22" fill="#fff" stroke="#000" stroke-width="4"/>
              <text x="490" y="95" text-anchor="middle" font-size="18">Leak prevention as a 3-layer model</text>

              <rect x="120" y="125" width="240" height="95" rx="18" fill="#e7f3ff" stroke="#000" stroke-width="4"/>
              <text x="240" y="160" text-anchor="middle" font-size="14">Layer 1</text>
              <text x="240" y="184" text-anchor="middle" font-size="14">DNS protection</text>

              <rect x="370" y="125" width="240" height="95" rx="18" fill="#f6ffe7" stroke="#000" stroke-width="4"/>
              <text x="490" y="160" text-anchor="middle" font-size="14">Layer 2</text>
              <text x="490" y="184" text-anchor="middle" font-size="14">Kill switch</text>

              <rect x="620" y="125" width="240" height="95" rx="18" fill="#ffe8d6" stroke="#000" stroke-width="4"/>
              <text x="740" y="160" text-anchor="middle" font-size="14">Layer 3</text>
              <text x="740" y="184" text-anchor="middle" font-size="14">IPv6 / DoH / WebRTC</text>

              <path d="M 360 173 L 370 173" stroke="#000" stroke-width="6"/>
              <path d="M 610 173 L 620 173" stroke="#000" stroke-width="6"/>
              <polygon points="368,173 350,163 350,183" fill="#000"/>
              <polygon points="618,173 600,163 600,183" fill="#000"/>

              <text x="490" y="255" text-anchor="middle" font-size="13">Result: stable privacy across updates, sleep/wake and network changes.</text>
            </svg>
          </div>
          <div class="svg-caption">Diagram 3: Three layers that prevent most real-world DNS leaks.</div>
        </div>

        <h2>Repeatable troubleshooting checklist</h2>
        <ol>
          <li>Connect VPN ‚Üí run DNS/IPv6/WebRTC tests.</li>
          <li>Enable kill switch ‚Üí retest after sleep/wake.</li>
          <li>Disable split tunnelling (for testing) ‚Üí compare results.</li>
          <li>Handle IPv6 + browser DoH/WebRTC ‚Üí retest.</li>
          <li>Restart router/device ‚Üí retest (catches intermittent leaks).</li>
        </ol>

        <div class="table-scroll">
          <table>
            <caption>A ‚Äúleak day‚Äù plan (so you don‚Äôt forget)</caption>
            <thead>
              <tr>
                <th>When</th>
                <th>What you do</th>
                <th>Time</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>After OS/VPN updates</td>
                <td>Run quick DNS/IPv6/WebRTC tests + reconnect once</td>
                <td>3‚Äì5 min</td>
              </tr>
              <tr>
                <td>After network change</td>
                <td>Retest (Wi-Fi ‚Üî hotspot)</td>
                <td>2‚Äì4 min</td>
              </tr>
              <tr>
                <td>Before streaming / travel</td>
                <td>Check split tunnelling + DNS results</td>
                <td>3‚Äì6 min</td>
              </tr>
              <tr>
                <td>Monthly</td>
                <td>10-minute hygiene check + quick notes</td>
                <td>10 min</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h2 id="faq">FAQ</h2>
        <dl>
          <dt>How often should I test for leaks?</dt>
          <dd>After initial setup, after OS/VPN updates, after sleep/wake issues, and whenever you change networks (home, work, public Wi-Fi).</dd>

          <dt>Are free VPNs more likely to leak?</dt>
          <dd>Often, yes ‚Äî they may lack robust DNS enforcement and kill switch behaviour. If you‚Äôre comparing, see <a href="/en-gb/blog/free-vs-paid-vpn-uk.html">free vs paid VPN</a>.</dd>

          <dt>Is public DNS (1.1.1.1 / 9.9.9.9) enough?</dt>
          <dd>It‚Äôs usually better than ISP DNS, but the ideal is DNS fully inside the VPN tunnel to reduce correlation risk.</dd>

          <dt>What‚Äôs the fastest ‚Äúfirst fix‚Äù?</dt>
          <dd>Enable kill switch + DNS protection in your VPN app, then retest after sleep/wake.</dd>
        </dl>

        <h2>Conclusion</h2>
        <p>
          DNS leaks are manageable if you treat testing as a habit, not a one-time task.
          A solid setup is: DNS protection + kill switch + clean handling of IPv6 and browser features.
          Retest on the days leaks actually happen ‚Äî update day, network change day, and sleep/wake day.
        </p>

        <!-- CONTENT_END -->
      </div>
    </section>

    <!-- VIDEO -->
    <section class="section section-alt">
      <div class="container">
        <h2>Short video: VPN privacy explained in plain English</h2>
        <p class="note">
          <strong>Key takeaway:</strong> the main job of a VPN is to separate <strong>who you are</strong> (your IP, ISP) from <strong>what you do</strong> (sites you access).
          DNS leaks rebuild that bridge ‚Äî so we test.
        </p>

        <div class="video-wrap">
          <iframe
            src="https://www.youtube-nocookie.com/embed/rzcAKFaZvhE?rel=0&modestbranding=1"
            title="VPN World ‚Äî video"
            loading="lazy"
            frameborder="0"
            referrerpolicy="strict-origin-when-cross-origin"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen></iframe>
        </div>

        <p>
          If the player doesn‚Äôt load, watch on YouTube:
          <a href="https://www.youtube.com/watch?v=rzcAKFaZvhE" target="_blank" rel="nofollow noopener noreferrer">https://www.youtube.com/watch?v=rzcAKFaZvhE</a>.
        </p>
      </div>
    </section>

    <!-- RELATED_START -->
    <section class="section">
      <div class="container">
        <h2>Related articles</h2>
        <div class="related-grid">
          <div class="related-card"><strong>Related:</strong> <a href="/en-gb/blog/what-is-a-vpn-uk.html">What is a VPN? (UK)</a></div>
          <div class="related-card"><strong>Related:</strong> <a href="/en-gb/blog/vpn-kill-switch-uk.html">VPN Kill Switch: stop leaks</a></div>
          <div class="related-card"><strong>Related:</strong> <a href="/en-gb/blog/vpn-optimal-settings-uk.html">Optimal VPN settings (UK)</a></div>
          <div class="related-card"><strong>Related:</strong> <a href="/en-gb/blog/proxy-vs-vpn-uk.html">Proxy vs VPN (UK)</a></div>
          <div class="related-card"><strong>Related:</strong> <a href="/en-gb/blog/vpn-public-wifi-uk.html">VPN on public Wi-Fi (UK)</a></div>
          <div class="related-card"><strong>Related:</strong> <a href="/en-gb/blog/no-logs-vpn-uk.html">No-logs VPN (UK)</a></div>
        </div>
      </div>
    </section>
    <!-- RELATED_END -->

    <!-- AUTHOR -->
    <section class="section">
      <div class="container">
        <div class="author-box">
          <img src="../../assets/img/author/denys-shchur.webp" alt="Portrait of Denys Shchur" class="author-avatar">
          <div>
            <h3>About the author</h3>
            <p>
              <strong><a href="/en-gb/about-denys-shchur.html" style="text-decoration:none;">Denys Shchur</a></strong>
              is the creator of VPN World, focusing on practical, test-driven guides about VPNs, online privacy and secure remote work.
              He spends far too much time checking for leaks so you don‚Äôt have to.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA (late) -->
    <section class="section">
      <div class="container article">
        <div class="cta-box" aria-label="Recommended VPNs">
          <h2>Recommended VPNs</h2>
          <p class="cta-note">Affiliate links (nofollow/sponsored).</p>
          <div class="cta-buttons" aria-label="Affiliate offers">
            <a href="https://go.nordvpn.net/aff_c?aff_id=2495&offer_id=312&url_id=2584" class="nordvpn" target="_blank" rel="nofollow sponsored noopener noreferrer">Try NordVPN ‚Äî DNS protection + kill switch</a>
            <a href="https://www.tkqlhce.com/click-101525886-17061430" class="surfshark" target="_blank" rel="nofollow sponsored noopener noreferrer">Try Surfshark ‚Äî RAM-only servers</a>
            <a href="https://www.dpbolvw.net/click-101525886-15834536" class="proton" target="_blank" rel="nofollow sponsored noopener noreferrer">Try Proton VPN ‚Äî privacy-first</a>
          </div>
          <p class="human-note">Disclosure: VPN World may earn a commission if you subscribe via these links ‚Äî without changing your price.</p>
        </div>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container">
      <p><strong>VPN World</strong> ¬∑ Independent service about privacy, security, and practical VPN use.</p>
      <p>
        <a href="/en-gb/privacy.html">Privacy</a> ¬∑
        <a href="/en-gb/disclosure.html">Disclosure</a> ¬∑
        <a href="mailto:u1797008805@gmail.com">Contact</a>
      </p>
      <p>¬© 2026 VPN World</p>
    </div>
  </footer>

  <script src="../../assets/js/main.js"></script>
  <!-- Cookie Consent (canonical) -->
<div id="cookie-consent-layer" class="cookie-layer" aria-hidden="true"></div>
<div id="cookie-banner" class="cookie-banner" role="dialog" aria-live="polite" aria-label="Cookie consent">
  <div class="cookie-banner__inner">
    <div class="cookie-banner__text">
      <span class="cookie-banner__msg">We use cookies.</span>
      <a class="cookie-banner__link" href="/en-gb/privacy.html" rel="nofollow">Privacy</a>
    </div>
    <div class="cookie-banner__actions">
      <button id="cookie-accept" type="button">Accept</button>
      <button id="cookie-reject" type="button">Reject</button>
    </div>
  </div>
</div>
<!-- /Cookie Consent (canonical) -->

</body>
</html>

<!-- PAGE: https://dloran1.github.io/en-gb/blog/vpn-dns-leak-uk.html -->
